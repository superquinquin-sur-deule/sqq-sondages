{#include base.html}
{#title}Sondage - Vos habitudes{/title}
{#header}Sondage Coop' - Vos habitudes{/header}
{#body}

<div id="already-answered" class="bg-white rounded-xl border-2 border-sqq-yellow p-6 sm:p-8 shadow-sm text-center max-w-lg mx-auto hidden">
    <div class="text-5xl mb-4">&#9888;</div>
    <h2 class="text-sqq-brown text-xl font-bold mb-4">Vous avez déjà répondu au sondage</h2>
    <p class="text-gray-600">
        Nous avons bien enregistré vos réponses. Merci pour votre participation !
    </p>
</div>

<form action="/submit" method="post" id="survey-form" class="space-y-8">

    <!-- Question 1 -->
    <div class="bg-white rounded-xl border-2 border-sqq-yellow p-4 sm:p-6 shadow-sm">
        <h2 class="text-sqq-brown text-lg font-bold mb-4">
            1. En semaine et le samedi, quels sont les jours et moments où vous vous seriez le plus susceptible de faire vos courses alimentaires au magasin ?
        </h2>
        <p class="text-sm text-gray-600 mb-4">Cochez tous les créneaux qui vous conviennent.</p>
        <p id="q1-error" class="hidden text-red-600 text-sm mb-4">Veuillez sélectionner au moins un créneau.</p>

        <div class="overflow-x-auto">
            <table class="w-full text-sm">
                <thead>
                    <tr class="bg-sqq-brown text-white">
                        <th class="p-1 sm:p-2 text-left rounded-tl-lg"></th>
                        {#for slot in shoppingSlots}
                        <th class="p-1 sm:p-2 text-center {#if slot_isLast}rounded-tr-lg{/if}">{slot}</th>
                        {/for}
                    </tr>
                </thead>
                <tbody>
                    {#for day in days}
                    <tr class="{#if day_index.mod(2) == 0}bg-sqq-light{#else}bg-white{/if}">
                        <td class="p-1 sm:p-2 font-medium text-sqq-brown">{day}</td>
                        {#for slotKey in shoppingSlotKeys}
                        <td class="p-1 sm:p-2 text-center">
                            <input type="checkbox"
                                   name="{dayKeys.get(day_index)}_{slotKey}"
                                   value="on"
                                   class="w-4 h-4 sm:w-5 sm:h-5 accent-sqq-yellow cursor-pointer">
                        </td>
                        {/for}
                    </tr>
                    {/for}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Question 2 -->
    <div class="bg-white rounded-xl border-2 border-sqq-yellow p-4 sm:p-6 shadow-sm">
        <h2 class="text-sqq-brown text-lg font-bold mb-4">
            2. Quel créneau horaire vous conviendrait le mieux pour faire votre service de 2h45 au magasin ?
        </h2>
        <p class="text-sm text-gray-600 mb-4">
            Choisissez vos 3 créneaux préférés par ordre de priorité (1 = premier choix).
        </p>

        <div class="space-y-4">
            {#for priority in 3}
            <div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4">
                <label class="font-medium text-sqq-brown sm:w-24 sm:shrink-0" for="priority_{priority_count}">
                    Choix n°{priority_count}
                </label>
                <select name="priority_{priority_count}" id="priority_{priority_count}"
                        class="priority-select flex-1 border-2 border-gray-300 rounded-lg p-2 focus:border-sqq-yellow focus:outline-none"
                        required>
                    <option value="">-- Sélectionnez un créneau --</option>
                    {#for entry in serviceOptions.entrySet()}
                    <option value="{entry.key}">{entry.value}</option>
                    {/for}
                </select>
            </div>
            {/for}
        </div>
    </div>

    <!-- Submit -->
    <div class="text-center">
        <button type="submit"
                class="w-full sm:w-auto bg-sqq-yellow text-sqq-brown font-bold py-3 px-8 rounded-full text-lg hover:brightness-110 transition shadow-md">
            Envoyer mes réponses
        </button>
    </div>

</form>

{/body}
{/include}
